# CDN Assets Manager for Laravel

##### Content Delivery Network Package for Laravel

The package provides the developer the ability to upload his assets (or any public file) to a CDN with a single artisan command.
And then it allows him to switch between the local and the online version of the files.

A custom CDN provider is included, but you can implement your own driver to interface with any standard CDN like AWS, Google, Cloudflare ...

#### Laravel Support
- Tested with Laravel 5.2
- Not tested with higher Laravel versions 

## Installation

#### Via Composer

Require `webravolab/cdn` in your project:

```bash 
composer require webravolab/cdn
```

You must register manually the service provider:

Add the service provider to `config/app.php`:

```php
'providers' => array(
     //...
     Webravolav\Cdn\CdnServiceProvider::class,
),
```

Publish the default configuration file:

```bash
php artisan vendor:publish webravolab/cdn
```

## Dependencies

This package uses the wonderful [gregwar/image](https://github.com/Gregwar/Image) to process images and [guzzlehttp/guzzle](https://github.com/guzzlehttp/guzzle) 
to manage assets upload to cdn.

## Configuration

Configuration is copied at `config/webravo_cdn.php`

##### Default Provider
```php
'default' => 'Webravo',
```

##### CDN Provider Configuration

You must define just your cdn url and specific url to upload assets

```php
'providers' => [
    'Webravo' => [
        'url' => 'https://www.my-cdn.com',
        'upload_url' => 'https://www.my-cdn.com/cdn/upload',
    ],
],
```

##### Bypass

To disable CDN and load your assets from local machine for testing purposes, set the `bypass` option to `true`:

```php
'bypass' => true,
```

## Usage


```blade
{{ Cdn::image('/img/image.png') }}
```
*simplest example without any option* 

```blade
{{ Cdn::image('/img/source-image.png', ['name' => '/images/cdn-image.png', 'type' => 'png', 'mode' => 'resize', 'size' => '150x100', 'background' => 'black']) }}
```
*complex image transform and custom name*

### Elixir assets

```blade
{{Cdn::elixir('assets/js/main.js')}}        // example result: https://www.my-cdn.com/build/assets/js/main-85cafe36ff.js

{{Cdn::elixir('assets/css/style.css')}}        // example result: https://www.my-cdn.com/build/assets/css/style-2d558139f2.css
```

*Note: the `elixir` works the same as the Laravel `elixir` it loads the manifest.json file from build folder and choose the correct file revision generated by  gulp:*

*Note: currently, the `elixir` command does not copy assets to Cdn, but simply add/replace the url with the Cdn url* 

## Test

No test available yet.

## Support

[On Github](https://github.com/Webravolab/cdn/issues)


## Contributing

- This is a heavy customized package for Webravo internal use. You should fork and try to customize for your needs.

## Credits

- Heavily inspired by [Vinelab/cdn](https://github.com/Vinelab/cdn) package for package organization and facade interface.

## License

The MIT License (MIT). Please see [License File](https://github.com/Webravolab/cdn/blob/master/LICENSE) for more information.

